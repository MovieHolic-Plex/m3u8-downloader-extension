# M3U8 Downloader 테스트 가이드 (v2 - 자동 감지)

## 중요 변경사항

이제 확장 프로그램이 **자동으로 M3U8를 감지**합니다!
- 웹페이지의 네트워크 요청을 모니터링
- M3U8 파일 요청을 자동으로 감지
- 확장 프로그램 아이콘에 개수 표시 (배지)
- 클릭 한 번으로 감지된 URL 선택

## 1단계: Chrome에 확장 프로그램 설치

### 기존에 설치한 경우
1. `chrome://extensions/` 접속
2. "M3U8 Video Downloader" 찾기
3. **새로고침 버튼 클릭** (↻ 아이콘) - 중요!
4. 또는 제거 후 재설치

### 새로 설치하는 경우
1. Chrome 브라우저 열기
2. 주소창에 `chrome://extensions/` 입력
3. "개발자 모드" 활성화
4. "압축해제된 확장 프로그램을 로드합니다" 클릭
5. 이 폴더 선택: `C:\Users\hyeon\PycharmProjects\m3u8-downloader-extension`

## 2단계: 자동 감지 테스트

### 테스트 시나리오 1: 제공된 URL 직접 접속

1. **Chrome에서 제공된 M3U8 URL 접속:**
   ```
   https://api.wecandeo.com/video/castAll.m3u8?k=BOKNS9AQWrFShbvDFYKgDnpipLknSJ6tcsV6MqKmZNisww2B0wFRsWafHFwTOX8carvlYyqgZT3r90iiI5pDN495yii8hisD1oF9KUAqyI8isEx2XoHf8EUAMRMV13Uoisipml1gV9PkQWysGDpaMiiYZZlOotAieie
   ```

2. **확장 프로그램 아이콘 확인**
   - 아이콘에 녹색 배지로 "1" 또는 숫자가 표시되어야 함
   - 표시되지 않으면 페이지 새로고침

3. **확장 프로그램 열기**
   - 확장 프로그램 아이콘 클릭
   - "페이지에서 감지된 M3U8 (1)" 섹션 확인

4. **감지된 URL 선택**
   - 감지된 URL 항목 클릭
   - "URL이 입력되었습니다" 메시지 확인
   - 하단 입력 필드에 URL이 자동으로 입력됨

5. **다운로드 진행**
   - 파일명 입력 (예: `test_video`)
   - "Download Video" 버튼 클릭
   - 다운로드 진행

### 테스트 시나리오 2: 비디오 스트리밍 사이트

1. **M3U8를 사용하는 비디오 사이트 방문**
   - YouTube (일부), Twitch, Vimeo 등
   - 또는 공개 스트리밍 데모 사이트

2. **비디오 재생**
   - 비디오를 재생하면 M3U8 요청이 발생

3. **자동 감지 확인**
   - 확장 프로그램 아이콘에 배지 숫자 표시
   - 여러 개가 감지될 수 있음 (master, variants 등)

4. **URL 선택 및 다운로드**
   - 확장 프로그램 열기
   - 원하는 URL 클릭
   - 다운로드 진행

### 테스트 시나리오 3: 공개 테스트 스트림

다음 공개 M3U8 스트림으로 테스트:

```
https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8
```

1. 위 URL을 Chrome 주소창에 입력
2. 확장 프로그램 아이콘에 배지 확인
3. 확장 프로그램 열기
4. 감지된 URL 확인 및 다운로드

## 3단계: 주요 기능 테스트

### 배지 기능
- [ ] M3U8 감지 시 아이콘에 숫자 배지 표시
- [ ] 배지 색상이 녹색 (#4CAF50)
- [ ] 여러 M3U8 감지 시 개수 증가
- [ ] 다른 페이지로 이동 시 배지 초기화

### 감지 목록
- [ ] 감지된 URL이 목록에 표시됨
- [ ] URL이 너무 길면 축약되어 표시
- [ ] 마우스 오버 시 전체 URL 툴팁 표시
- [ ] "N초/분/시간 전" 시간 표시

### URL 선택
- [ ] URL 클릭 시 입력 필드에 자동 입력
- [ ] 클릭 시 녹색 플래시 효과
- [ ] 성공 메시지 표시

### Clear 기능
- [ ] "Clear" 버튼 클릭 시 목록 초기화
- [ ] 배지 제거됨
- [ ] "감지하지 못했습니다" 메시지 표시

### 수동 입력 (기존 기능)
- [ ] 수동으로 URL 입력 가능
- [ ] 다운로드 정상 작동

## 4단계: 개발자 도구로 확인

### Background Script 로그

1. `chrome://extensions/` 접속
2. "M3U8 Video Downloader" 찾기
3. "서비스 워커" 옆 "검사" 클릭
4. Console 탭에서 로그 확인:
   ```
   Detected M3U8: https://...
   ```

### 네트워크 요청 확인

1. 테스트 페이지에서 F12 (개발자 도구)
2. Network 탭
3. Filter에 "m3u8" 입력
4. M3U8 요청 확인
5. 확장 프로그램이 동시에 감지하는지 확인

## 5단계: 문제 해결

### M3U8가 감지되지 않음

**원인 1: 페이지가 M3U8를 사용하지 않음**
- 해결: 다른 스트리밍 사이트 시도
- 해결: 개발자 도구 Network 탭에서 확인

**원인 2: 확장 프로그램이 업데이트되지 않음**
- 해결: chrome://extensions/에서 확장 프로그램 새로고침
- 해결: Chrome 재시작

**원인 3: 권한 문제**
- 해결: manifest.json에 webRequest 권한 확인
- 해결: 확장 프로그램 재설치

### 배지가 표시되지 않음

- 확장 프로그램 아이콘을 도구 모음에 고정했는지 확인
- 확장 프로그램 재로드 (새로고침)
- 페이지 새로고침

### "No detected" 메시지만 표시

- 현재 탭에서 M3U8 요청이 발생했는지 확인
- 다른 탭의 감지 내역은 표시되지 않음 (탭별 독립)
- 비디오를 재생해보세요

## 6단계: 성능 테스트

### 여러 M3U8 감지
1. 여러 비디오가 있는 페이지 방문
2. 모든 M3U8가 감지되는지 확인
3. 최대 10개까지 저장됨

### 탭별 독립성
1. 여러 탭에서 각각 비디오 재생
2. 각 탭마다 독립적인 배지 숫자
3. 탭 전환 시 해당 탭의 감지 목록 표시

### 메모리 정리
1. 탭 닫기 → 해당 탭의 데이터 삭제
2. 페이지 이동 → 이전 데이터 초기화

## 완료 체크리스트

- [ ] 확장 프로그램 설치 완료
- [ ] 자동 감지 기능 작동 확인
- [ ] 배지 표시 확인
- [ ] URL 클릭으로 자동 입력 확인
- [ ] Clear 기능 작동 확인
- [ ] 다운로드 정상 완료
- [ ] 여러 M3U8 감지 테스트
- [ ] 탭별 독립성 확인

## 다음 단계

모든 테스트를 통과하면 확장 프로그램이 정상 작동하는 것입니다!

### 추가 개선 아이디어
- 특정 도메인 필터링
- 해상도별 스트림 자동 선택
- 즐겨찾기 기능
- 다운로드 히스토리

문제가 있으면 개발자 도구의 콘솔 로그를 확인하거나 질문해주세요!
